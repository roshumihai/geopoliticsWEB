{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2 class="continut-articol-h2">{{ titlu }}</h2>
    <div class="continut-articol">
        {{ continut|safe }}
        <p class="data">{{ data }} | Scris de: <strong>{{ autor }}</strong></p>
    </div>

    <button id="likeBtn"
        class="like-btn {{ 'liked' if a_dat_like else '' }}"
        data-id="{{ articol_id }}">
    üëç <span id="likeText">{{ '√é»õi place' if a_dat_like else 'Like' }}</span>
    </button>
    <span id="likeCount">{{ likes }} like{{ 'uri' if likes != 1 else '' }}</span>

    <p><a href="/">‚¨ÖÔ∏è √énapoi la articole</a></p>
</div>

<script>
document.getElementById("likeBtn").addEventListener("click", function () {
    const btn = this;
    const id = btn.getAttribute("data-id");

    fetch(`/api/like/${id}`, {
        method: "POST"
    })
    .then(r => r.json())
    .then(data => {
        if (data.success) {
            const likeText = document.getElementById("likeText");
            const likeCount = document.getElementById("likeCount");

            if (data.actiune === "liked") {
                btn.classList.add("liked");
                likeText.textContent = "√é»õi place";
            } else {
                btn.classList.remove("liked");
                likeText.textContent = "Like";
            }

            likeCount.textContent = `${data.total} like${data.total !== 1 ? 'uri' : ''}`;
        }
    });
});
</script>
{% endblock %}